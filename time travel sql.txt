CREATE TABLE Employees (
    EmployeeID INT PRIMARY KEY,
    Name NVARCHAR(100),
    Position NVARCHAR(100),
    CreatedTime DATETIME2 DEFAULT SYSUTCDATETIME(), -- Default to current UTC date and time
    ValidFrom DATETIME2 GENERATED ALWAYS AS ROW START HIDDEN NOT NULL,
    ValidTo DATETIME2 GENERATED ALWAYS AS ROW END HIDDEN NOT NULL,
    PERIOD FOR SYSTEM_TIME (ValidFrom, ValidTo)
)
WITH (SYSTEM_VERSIONING = ON (HISTORY_TABLE = dbo.EmployeesHistory));

-- Insert data
INSERT INTO Employees (EmployeeID, Name, Position)



VALUES (2, 'vivek', 'Software Developer');
-- Update data
delete from Employees
WHERE EmployeeID = 2;
-- Query current data
SELECT * FROM Employees;

select * from EmployeesHistory



SELECT * FROM Employees
FOR SYSTEM_TIME AS OF '2024-07-30T11:47:58.8017274';


-- Query historical data between two points in time
SELECT * FROM Employees
FOR SYSTEM_TIME BETWEEN '2024-01-01T00:00:00.0000000' AND '2024-07-01T00:00:00.0000000';




ALTER TABLE Employees
SET (SYSTEM_VERSIONING = OFF);

-- Drop the table
DROP TABLE Employees;
DROP TABLE EmployeesHistory